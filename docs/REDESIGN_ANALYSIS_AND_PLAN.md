# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–ª–∞–Ω —Ä–µ–¥–∏–∑–∞–π–Ω–∞

## 1. –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (Vite + React + TypeScript + Tailwind)
- **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** `frontend/src/main.tsx` ‚Üí `App.tsx`
- **–°—Ç–∏–ª–∏:** `index.css` (Tailwind + CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Telegram `--tg-theme-bg-color`, `--tg-theme-text-color`)
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
  - `App.tsx` ‚Äî –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω: –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Å—á—ë—Ç—á–∏–∫ –ø—Ä–∏–≤—ã—á–µ–∫, SubscriptionManager, AddHabitForm, —Å–ø–∏—Å–æ–∫ HabitItem
  - `AddHabitForm.tsx` ‚Äî —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –æ–¥–∏–Ω time picker)
  - `HabitItem.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏: —á–µ–∫–±–æ–∫—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –º–µ–Ω—é (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ, —É–¥–∞–ª–∏—Ç—å), streak, inline-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
  - `SubscriptionManager.tsx` ‚Äî –æ–±—ë—Ä—Ç–∫–∞: –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (Free/Premium) + —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è SubscriptionPlans
  - `SubscriptionPlans.tsx` ‚Äî —Ç–∞–±—ã –ú–µ—Å—è—Ü/–ì–æ–¥, —Ü–µ–Ω—ã, –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, –∫–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã
  - `SubscriptionStatus.tsx` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π (–∞–∫–∫–æ—Ä–¥–µ–æ–Ω)
- **–°–µ—Ä–≤–∏—Å—ã:** `services/api.ts` ‚Äî habitsApi, subscriptionApi (axios + x-telegram-id)
- **–¢–∏–ø—ã:** `types/index.ts` ‚Äî Habit, CreateHabitDto, UpdateHabitDto, SubscriptionStatus, SubscriptionPlan –∏ –¥—Ä.

### –ë—ç–∫–µ–Ω–¥ (Express + Prisma + PostgreSQL)
- **–†–æ—É—Ç—ã:** `api/habits`, `api/subscription`, `api/payments`
- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:** habits (CRUD, complete, stats), subscription (status, plans, create-payment, check-latest-payment), payments (webhook)
- **Middleware:** auth (x-telegram-id), subscription (checkFreeLimits, checkSubscription), validation (create/update habit)
- **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:** FREE_HABITS_LIMIT = 3
- **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:** –ø—Ä–æ–≤–µ—Ä–∫–∞ Premium –ø—Ä–∏ create/update habit; –¥–ª—è Free ‚Äî reminderEnabled=false, reminderTime=null

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Prisma)
- **User:** telegramId, timezone, subscriptionType, subscriptionStatus, subscriptionExpiresAt, subscriptionStartedAt
- **Habit:** name, description, reminderTime (String?, HH:MM), reminderEnabled (Boolean)
- **HabitLog:** habitId, date (—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å habitId+date)
- **Payment:** userId, yookassaId, amount, status, metadata (planId, durationDays)

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (Vercel serverless)
- **api/reminders.ts** ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ cron –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω; —á–∏—Ç–∞–µ—Ç –ø—Ä–∏–≤—ã—á–∫–∏ —Å reminderEnabled=true –∏ reminderTime; –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –≤ UTC –ø–æ timezone –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è; –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram, –µ—Å–ª–∏ –ø—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–µ–≥–æ–¥–Ω—è.

---

## 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ –∑–æ–Ω–∞–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

| –ó–æ–Ω–∞           | –§—Ä–æ–Ω—Ç–µ–Ω–¥                          | –ë—ç–∫–µ–Ω–¥ / API                          | –ë–î / Cron                    |
|----------------|------------------------------------|----------------------------------------|------------------------------|
| **–ü—Ä–∏–≤—ã—á–∫–∏**   | App, AddHabitForm, HabitItem       | habits.controller, habits.routes       | Habit, HabitLog              |
| **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è**| AddHabitForm (time), HabitItem (edit) | habits create/update (reminderTime)  | Habit.reminderTime, api/reminders |
| **–ü–æ–¥–ø–∏—Å–∫–∞**   | SubscriptionManager, SubscriptionPlans, SubscriptionStatus | subscription.controller, subscription.routes | User.subscription* |
| **–¶–µ–ª–∏**       | –ù–µ—Ç                                | –ù–µ—Ç                                    | –ù–µ—Ç (–¥–æ–±–∞–≤–∏—Ç—å)               |

---

## 3. –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–∑–∞ 1 ‚Äî –†–µ–¥–∏–∑–∞–π–Ω –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ (–æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ)
- –í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫: –∏–∫–æ–Ω–∫–∞, –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–¢—Ä–µ–∫–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫", –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ (RU).
- –°—á—ë—Ç—á–∏–∫: "–ü—Ä–∏–≤—ã—á–µ–∫: X –∏–∑ 3 / ‚àû" —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º –∞–∫—Ü–µ–Ω—Ç–æ–º.
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏: Free ‚Äî –±–µ–π–¥–∂ "Free" + –∫–Ω–æ–ø–∫–∞ "–ü–æ–ª—É—á–∏—Ç—å PRO"; Pro ‚Äî —Ü–≤–µ—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ + –æ—Å—Ç–∞—Ç–æ–∫ –¥–Ω–µ–π + "–ü—Ä–æ–¥–ª–∏—Ç—å".
- –£–ª—É—á—à–∏—Ç—å –æ—Ç—Å—Ç—É–ø—ã, —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫—É, –∫–æ–Ω—Ç—Ä–∞—Å—Ç; –∞–¥–∞–ø—Ç–∏–≤; —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∏–ª—å Telegram Mini App.

### –§–∞–∑–∞ 2 ‚Äî Paywall (—Ç–∞—Ä–∏—Ñ—ã –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞)
- –¢–∞—Ä–∏—Ñ—ã: –ú–µ—Å—è—Ü 79‚ÇΩ, –ì–æ–¥ 699‚ÇΩ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, "–õ—É—á—à–∏–π –≤—ã–±–æ—Ä"), –ù–∞–≤—Å–µ–≥–¥–∞ 2199‚ÇΩ (–æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫).
- Lifetime: "–î–æ—Å—Ç—É–ø–Ω–æ –¥–æ {–¥–∞—Ç–∞}", –≤–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å.
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: ‚àû –ø—Ä–∏–≤—ã—á–µ–∫, üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞, üéØ –¶–µ–ª–∏, üé® –¢–µ–º—ã, ü§ñ –£–º–Ω—ã–µ —Å–æ–≤–µ—Ç—ã.
- –ë—ç–∫–µ–Ω–¥: –¥–æ–±–∞–≤–∏—Ç—å –ø–ª–∞–Ω `lifetime` (durationDays –±–æ–ª—å—à–æ–π –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ expiresAt).

### –§–∞–∑–∞ 3 ‚Äî –†–µ–¥–∏–∑–∞–π–Ω –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- –£–±—Ä–∞—Ç—å overflow: –≤—ã–Ω–µ—Å—Ç–∏ –≤ bottom sheet –∏–ª–∏ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—É—é –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—É—é –ø–∞–Ω–µ–ª—å.
- –†–µ–∂–∏–º—ã: –†–∞–∑ –≤ –¥–µ–Ω—å (–≤—Ä–µ–º—è), –ò–Ω—Ç–µ—Ä–≤–∞–ª (–∫–∞–∂–¥—ã–µ N —á–∞—Å–æ–≤), –ü–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏, –ö–∞—Å—Ç–æ–º (–ø–æ–∑–∂–µ).
- UI: —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª [–î–µ–Ω—å | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ù–µ–¥–µ–ª—è | –ö–∞—Å—Ç–æ–º], –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞.
- –ë–î: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å reminderTime (HH:MM); —Ä–∞—Å—à–∏—Ä–∏—Ç—å —á–µ—Ä–µ–∑ JSON reminderSchedule (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ), cron ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –æ–±–∞ —Ñ–æ—Ä–º–∞—Ç–∞.

### –§–∞–∑–∞ 4 ‚Äî –¶–µ–ª–∏ –≤ Add/Edit Habit
- –°–µ–∫—Ü–∏—è "–¶–µ–ª—å": –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –í–∫–ª/–í—ã–∫–ª.
- –¢–∏–ø—ã: —Å–µ—Ä–∏—è –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑ –≤ –ø–µ—Ä–∏–æ–¥, –ø–µ—Ä–∏–æ–¥ (21/30/90).
- –ü—Ä–µ–≤—å—é: "21 –¥–µ–Ω—å –ø–æ–¥—Ä—è–¥ ‚Äî 7/21 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ".
- –ë–î: –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî goalEnabled, goalType, goalTarget, goalPeriodDays (–∏–ª–∏ JSON goalConfig).

### –§–∞–∑–∞ 5 ‚Äî –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Free / Pro
- Free: ‚â§3 –ø—Ä–∏–≤—ã—á–µ–∫, —Ç–æ–ª—å–∫–æ 1 –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –¥–µ–Ω—å, –±–µ–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤/–∫–∞—Å—Ç–æ–º–∞, –±–µ–∑ —Ü–µ–ª–µ–π.
- Pro: –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å paywall (–æ—Ç–∫—Ä—ã—Ç—å SubscriptionPlans).

### –§–∞–∑–∞ 6 ‚Äî –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –±—ç–∫–µ–Ω–¥–æ–º –∏ –ë–î
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –º–æ–¥–µ–ª–∏; —Ä–∞—Å—à–∏—Ä—è—Ç—å —Å—Ö–µ–º—É —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏; –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏; –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ; –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤.

### –§–∞–∑–∞ 7 ‚Äî –ö–∞—á–µ—Å—Ç–≤–æ –∏ —Ç–µ—Å—Ç—ã
- –°–ª–µ–¥–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–ª–æ–∂–Ω—ã–º –º–µ—Å—Ç–∞–º.
- –¢–µ—Å—Ç—ã: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏, —Ü–µ–ª–∏.

---

## 4. –†–∏—Å–∫–∏

| –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-----------|
| –ü–æ–ª–æ–º–∞—Ç—å —Ç–µ–∫—É—â–∏–µ API | –ù–µ –º–µ–Ω—è—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã GET/POST/PUT; –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è (reminderSchedule, goalConfig). |
| –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –ª–æ–º–∞–µ—Ç –ø—Ä–æ–¥ | –ù–æ–≤—ã–µ –ø–æ–ª—è nullable –∏–ª–∏ —Å default; –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å reminderTime. |
| Cron –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è | –í cron —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å reminderSchedule; –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å reminderTime –∫–∞–∫ "—Ä–∞–∑ –≤ –¥–µ–Ω—å". |
| Lifetime –ø–æ–¥–ø–∏—Å–∫–∞ | –•—Ä–∞–Ω–∏—Ç—å subscriptionExpiresAt –¥–∞–ª–µ–∫–æ –≤ –±—É–¥—É—â–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä +100 –ª–µ—Ç) –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–ª–∞–≥ isLifetime. |
| –†–æ—Å—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ UI –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π | –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ —Ç–æ–ª—å–∫–æ —Ä–µ–∂–∏–º "—Ä–∞–∑ –≤ –¥–µ–Ω—å" –≤ –Ω–æ–≤–æ–º UI (bottom sheet), –∏–Ω—Ç–µ—Ä–≤–∞–ª/–Ω–µ–¥–µ–ª—è ‚Äî —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø. |

---

–î–∞—Ç–∞: 2025-02-05
